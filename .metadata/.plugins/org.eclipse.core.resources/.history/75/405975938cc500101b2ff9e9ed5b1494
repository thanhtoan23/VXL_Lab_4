/*
 * scheduler.h
 *
 * Created on: 18 thg 11, 2025
 * Author: PC LEGION
 */

#ifndef INC_SCHEDULER_H_
#define INC_SCHEDULER_H_

#include<stdint.h>

// Định nghĩa lại uint8_t vì trong tệp gốc của bạn là 'unit8_t' bị sai chính tả
typedef uint8_t unit8_t;

typedef struct {
	void (*pTask)(void);
	uint32_t Delay;     // Delta Delay: Thời gian chờ còn lại cho đến khi tác vụ này chạy.
	uint32_t Period;    // Period: Chu kỳ chạy lại của tác vụ.
	unit8_t  RunMe;     // Flag: Số lần tác vụ cần được chạy.

	uint32_t TaskID;    // ID duy nhất (hoặc index ban đầu)
} sTasks;

#define SCH_MAX_TASKS 40

void SCH_Init(void);

// Hàm thêm tác vụ mới, giờ đây bao gồm sắp xếp
void SCH_Add_Task ( void (*pFunction)(),
		uint32_t DELAY,
		uint32_t PERIOD);

void SCH_Update(void);          // O(1)
void SCH_Dispatch_Tasks(void);  // O(1) hoặc O(N) tùy trường hợp
void SCH_Delete_Task(uint32_t ID); // Hàm xóa tác vụ

#endif /* INC_SCHEDULER_H_ */
